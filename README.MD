# DESAFIO FINAL DO BOOTCAMP NODEJS DA P√ìS-GRADUA√á√ÉO  

<hr>  

## Enunciado  

O desafio consiste em desenvolver uma API para controle de uma livraria online. A API dever√° gerenciar os cadastros de livros, autores, clientes e vendas. Tamb√©m dever√° gerenciar as informa√ß√µes da p√°gina de venda de cada livro com suas informa√ß√µes e avalia√ß√µes de leitores. Al√©m disso, a API dever√° ter controle de acesso aos endpoints, consultando o usu√°rio que deseja fazer a requisi√ß√£o em uma tabela de usu√°rios no banco de dados. Tamb√©m ser√° preciso desenvolver testes para a aplica√ß√£o.  

<hr>  

## Atividades  

- [ü¶â] **01 - Cria√ß√£o do banco de dados relacional:**  
   - [üåå] - Tabela: *clientes*  
        - cliente_id(SERIAL, n√£o nulo) ‚Äì chave prim√°ria da tabela. Identificador √∫nico do registro, gerado automaticamente.  
        - nome (VARCHAR, n√£o nulo) ‚Äì nome do cliente.
        - e-mail (VARCHAR, n√£o nulo) ‚Äì e-mail do cliente. Observa√ß√£o: ser√° utilizado para autenticar o cliente na API, juntamente com o campo de senha.  
        - senha (VARCHAR, n√£o nulo) ‚Äì senha do usu√°rio.  
        - telefone (VARCHAR, n√£o nulo) ‚Äì telefone do cliente.
        - endereco (VARCHAR, n√£o nulo) ‚Äì endere√ßo do cliente.
    
    - [üåå] - Tabela: *autores* 
         - autor_id (SERIAL, n√£o nulo) ‚Äì chave prim√°ria da tabela. Identificador √∫nico do registro, gerado automaticamente.  
         - nome (VARCHAR, n√£o nulo) ‚Äì nome do autor.  
         - e-mail (VARCHAR, n√£o nulo) ‚Äì e-mail do autor.  
         - telefone (VARCHAR, n√£o nulo) ‚Äì telefone do autor.  
    
    - [üåå] - Tabela: *livros*  
         - livro_id (SERIAL, n√£o nulo) ‚Äì chave prim√°ria da tabela. Identificador √∫nico do registro, gerado automaticamente.  
         - nome (STRING, n√£o nulo) ‚Äì nome do livro.  
         - valor (NUMERIC, n√£o nulo) ‚Äì valor do livro.  
         - estoque (INT, n√£o nulo) ‚Äì estoque do livro.  
         - autor_id (INT, n√£o nulo) ‚Äì chave estrangeira para a tabela de autores. Faz refer√™ncia a um autor.  

     - [üåå] - Tabela *vendas*  
          - venda_id (SERIAL, n√£o nulo) ‚Äì chave prim√°ria da tabela. Identificador √∫nico do registro, gerado automaticamente.  
          - valor (NUMERIC, n√£o nulo) ‚Äì valor da venda (pega o valor do livro vendido no momento da venda).    
          - data (DATE, n√£o nulo) ‚Äì data da venda.  
          - cliente_id (INT, n√£o nulo) ‚Äì chave estrangeira para a tabela de clientes. Faz refer√™ncia a um cliente.  
          - livro_id (INT, n√£o nulo) ‚Äì chave estrangeira para a tabela de livros. Faz refer√™ncia a um livro.

<br>  

- [ü¶â] **02 - Cria√ß√£o do banco de dados NoSQL:**  
      - A propriedade ‚ÄúlivroId‚Äù serve para manter uma refer√™ncia do id do livro do banco relacional. As propriedades ‚Äúdescricao‚Äù, ‚Äúp√°ginas‚Äù e ‚Äúeditora‚Äù dizem respeito ao livro em quest√£o. A propriedade ‚Äúavaliacoes" √© uma lista de avalia√ß√µes realizadas pelos clientes, possuindo o nome do cliente, a nota dada por ele e a descri√ß√£o da sua avalia√ß√£o.    
      <img src="./nosql.png">

<br>

- [] **03 - Desenvolvimento dos endpoints:**   
     - [] ***01 - Enpoints do Cliente***:  
       - [üòé] 01 - Cadastrar um cliente:  
           - M√©todo HTTP e URL: POST - http://localhost:3000/cliente  
           - Par√¢metros: objeto JSON com o nome, e-mail, senha, telefone e endere√ßo do cliente.

       - [üòé] 02 - Atualiza√ß√£o de um cliente:  
           - M√©todo HTTP e URL: PUT - http://localhost:3000/cliente  
           - Par√¢metros:  objeto JSON com o id do cliente que ser√° atualizado, o nome, email, senha, telefone e endere√ßo que ser√£o atualizados.  

       - [üòé] 03 - Exclus√£o de um cliente:  
           - Antes de excluir um cliente, verificar se existem vendas cadastradas para ele. Caso exista, bloquear a exclus√£o.
           - M√©todo HTTP e URL:  DELETE - http://localhost:3000/cliente/{clienteId}  
           - Par√¢metros: id do cliente passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/cliente/15

       - [] 04 - Consultar os clientes cadastrados:  
           - retornar todos os clientes, com todas as informa√ß√µes exceto o campo de senha, que n√£o deve ser retornado neste endpoint.
           - M√©todo HTTP e URL: GET - http://localhost:3000/cliente 
          
       - [] 05 - Consultar um cliente em espec√≠fico:  
           - Pegar o id do cliente e retornar um objeto JSON com suas informa√ß√µes, com todas as informa√ß√µes exceto o campo de senha, que n√£o deve ser retornado neste endpoint.
           - M√©todo HTTP e URL:   GET - http://localhost:3000/cliente/{clienteId}  
           - Par√¢metros:  id do cliente passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/cliente/15  
           <br><br>



     - [] ***02 - Enpoints do Autor***:  
       - [] 01 - Cadastrar um autor:  
           - M√©todo HTTP e URL: POST - http://localhost:3000/autor  
           - Par√¢metros: objeto JSON com o nome, e-mail, telefone e do autor.

       - [] 02 - Atualiza√ß√£o de um autor:  
           - M√©todo HTTP e URL: PUT - http://localhost:3000/autor  
           - Par√¢metros:   objeto JSON com o id do autor que ser√° atualizado, o nome, e-mail e telefone que ser√£o atualizados. 

       - [] 03 - Exclus√£o de um autor:  
           - Antes de excluir um autor, verificar se existem livros cadastradas para ele. Caso exista, bloquear a exclus√£o.
           - M√©todo HTTP e URL:  DELETE - http://localhost:3000/autor/{autorId}  
           - Par√¢metros: id do autor passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/autor/15

       - [] 04 - Consultar os autores cadastrados:  
           - retornar todos os clientes, com todas as informa√ß√µes.
           - M√©todo HTTP e URL: GET - http://localhost:3000/autor 
          
       - [] 05 - Consultar um autor em espec√≠fico:  
           - Pegar o id do autor e retornar um objeto JSON com suas informa√ß√µes.
           - M√©todo HTTP e URL:   GET - http://localhost:3000/autor/{autorId}  
           - Par√¢metros:  id do autor passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/autor/15  
           <br><br>  


     - [] ***03 - Enpoints do Livro***:  
       - [] 01 - Cadastrar um livro:  
           - M√©todo HTTP e URL: POST - http://localhost:3000/livro  
           - Par√¢metros: objeto JSON com o nome, valor e id do autor, que s√£o utilizados para salvar o registro no PostgreSQL. Os demais registros que s√£o inseridos na collection ‚ÄúlivroInfo‚Äù ser√£o inseridos em outro endpoint. 

       - [] 02 - Atualiza√ß√£o de um livro:  
           - M√©todo HTTP e URL: PUT - http://localhost:3000/livro  
           - Par√¢metros:   objeto JSON com o id do livro que ser√° atualizado, o valor do livro que ser√° atualizado. O endpoint n√£o deve permitir que o nome e autor do livro sejam alterados, evitando assim poss√≠veis inconsist√™ncias.   

       - [] 03 - Exclus√£o de um livro:  
           - Antes de excluir um livro, verificar se existem vendasrealizadas para ele. Caso exista, bloquear a exclus√£o.
           - M√©todo HTTP e URL:  DELETE - http://localhost:3000/autor/{livroId}  
           - Par√¢metros: id do autor passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/autor/15


       - [] 04 - Consultar um livro em espec√≠fico:  
           - Pegar o id do livro e retornar um objeto JSON com suas informa√ß√µes.
           - M√©todo HTTP e URL:   GET - http://localhost:3000/livro/{livroId}  
           - Observa√ß√µes: retornar as informa√ß√µes do PostgreSQL e do MongoDB. Este endpoint seria utilizado na aplica√ß√£o web quando o usu√°rio selecionasse um livro em espec√≠fico na listagem, sendo redirecionado para a p√°gina dele, com todas as suas informa√ß√µes e avalia√ß√µes. 
           - Par√¢metros:  id do livro passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/livro/15  

       - [] 05 - Consultar os livros cadastrados:  
           - Retornar todos os livros, com todas as informa√ß√µes.
           - M√©todo HTTP e URL: GET - http://localhost:3000/autor 
           - Observa√ß√µes: este endpoint e o pr√≥ximo devem retornar somente os dados do banco relacional, pois eles ser√£o utilizados somente na listagem dos livros. Caso o usu√°rio queira detalhar mais informa√ß√µes a respeito de um livro em espec√≠fico, estes dados s√£o obtidos no endpoint anterior.

       - [] 06 - Consultar os livros cadastrados de um autor em espec√≠fico:  
           - Pegar o id do autor na URL e retornar uma lista de seus livros, sendo cada venda representado por um objeto JSON com todas as propriedades.
           - M√©todo HTTP e URL: GET - http://localhost:3000/livro?autorId={autorId} 
           - Par√¢metros: id do livro passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http:/ localhost:3000/livro?autorId=15 (Sugest√£o: pode ser usada a mesma estrutura do endpoint do item 5, que consulta todos os livros, s√≥ que aqui nesse caso ele receberia um par√¢metro para filtrar o autor).

       - [] 07 - Cadastrar informa√ß√µes do livro:   
           - M√©todo HTTP e URL: POST ‚Äì http://localhost:3000/livro/info 
           - Par√¢metros: objeto JSON com o ‚ÄúlivroId‚Äù do livro que ter√° as informa√ß√µes cadastradas e as propriedades a serem salvas no MongoDB.

       - [] 08 - Atualizar informa√ß√µes do livro:   
           - M√©todo HTTP e URL: PUT ‚Äì http://localhost:3000/livro/info 
           - Par√¢metros: objeto JSON com o ‚ÄúlivroId‚Äù do livro que ter√° as informa√ß√µes atualizadas, e as propriedades a serem salvas no MongoDB.

       - [] 09 - Excluir informa√ß√µes do livro:   
           - M√©todo HTTP e URL: DELETE - http://localhost:3000/livro/info/{livroId}
           - Par√¢metros:  id do livro passado diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/livro/info/15.

       - [] 10 -Cadastrar uma avalia√ß√£o:  
           - M√©todo HTTP e URL: POST ‚Äì http://localhost:3000/livro/{livroId}/avaliacao 
           - Observa√ß√µes: este endpoint dever√° buscar no MongoDB o registro referente ao livro em quest√£o pela propriedade ‚ÄúlivroId‚Äù e inserir a avalia√ß√£o no array de avalia√ß√µes.

       - [] 11 - Excluir uma avalia√ß√£o:  
           - M√©todo HTTP e URL: DELETE - http://localhost:3000/livro/{livroId}/avaliacao/{index}
           - Par√¢metros: id do livro que ter√° a avalia√ß√£o exclu√≠da e o √≠ndice da avalia√ß√£o que ser√° exclu√≠da (como √© um array, o primeiro elemento √© o 0). Exemplo de um id de livro 15 e √≠ndice da avalia√ß√£o 0 passado na URL: http://localhost:3000/livro/15/avaliacao/0
           <br><br>  

     - [] ***03 - Enpoints da Venda***:  
       - [] 01 - Cadastrar uma venda:  
           - M√©todo HTTP e URL: POST - - http://localhost:3000/venda  
           - Par√¢metros:  objeto JSON com a data em que a venda foi realizada, o id do cliente que comprou o livro e o id do livro comprado. O valor da venda neste endpoint √© buscada da tabela do livro e inserida no registro da venda. A ideia desta a√ß√£o √© salvar o valor exato do livro no momento da venda, evitando que futuras altera√ß√µes no valor de um livro impacte nas vendas j√° realizadas daquele livro.  
           - Observa√ß√£o: antes de cadastrar a venda √© necess√°rio verificar se o livro tem estoque maior que zero. Se tiver, o endpoint deve permitir a inser√ß√£o do registro e deve atualizar o estoque do livro, diminuindo em uma unidade. Se n√£o tiver estoque, um erro deve ser retornado ao usu√°rio informando o que ocorreu.

       - [] 02 - Consultar um livro em espec√≠fico:  
           - Pegar o id  da venda e retornar um objeto JSON com suas informa√ß√µes.
           - M√©todo HTTP e URL:   GET - - http://localhost:3000/venda/{vendaId}   
           - Par√¢metros:   id da venda passada diretamente na URL, exemplo de um id de valor 15 passado na URL: http://localhost:3000/venda/15  

       - [] 03 - Consultar as vendas:  
           - Retornar todos os vendas.
           - M√©todo HTTP e URL: GET - http://localhost:3000/venda

       - [] 04 -  Consultar as vendas de um cliente em espec√≠fico:  
           - Pegar o id do cliente na URL e retornar uma lista das suas vendas, sendo cada venda representado por um objeto JSON com todas as propriedades.
           - M√©todo HTTP e URL: GET - http://localhost:3000/venda?clienteId={clienteId} 
           - Par√¢metros: id do venda passado diretamente na URL, exemplo de um id de valor 15 passado na URL:  http://localhost:3000/venda?clienteId=15 (Sugest√£o: pode ser usada a mesma estrutura do endpoint do item 3, que consulta todas as vendas, s√≥ que aqui nesse caso ele receberia um par√¢metro para filtrar o cliente).  

       - [] 05 -  Consultar as vendas de um livro em espec√≠fico:  
           - Pegar o id do livro na URL e retornar uma lista das suas vendas, sendo cada venda representado por um objeto JSON com todas as propriedades.
           - M√©todo HTTP e URL: GET - http://localhost:3000/venda?livroId={livroId} 
           - Par√¢metros: id do venda passado diretamente na URL, exemplo de um id de valor 15 passado na URL:   http://localhost:3000/venda?livroId=15 (Sugest√£o: pode ser usada a mesma estrutura do endpoint do item 3, que consulta todas as vendas, s√≥ que aqui nesse caso ele receberia um par√¢metro para filtrar o livro).

       - [] 06 -  Consultar as vendas de um autor em espec√≠fico:  
           - Pegar o id do livro na URL e retornar uma lista das suas vendas, sendo cada venda representado por um objeto JSON com todas as propriedades.
           - M√©todo HTTP e URL: GET - http://localhost:3000/venda?autorId={autorId} 
           - Par√¢metros: id do livro passado diretamente na URL, exemplo de um id de valor 15 passado na URL:   http://localhost:3000/venda?livroId=15 (Sugest√£o: pode ser usada a mesma estrutura do endpoint do item 3, que consulta todas as vendas, s√≥ que aqui nesse caso ele receberia um par√¢metro para filtrar o livro).

           <br><br>





